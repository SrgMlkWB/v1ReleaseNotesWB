<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-translate="title">Release Notes - WINBACK</title>
    <link rel="icon" href="img/LogoWBrond.png" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <nav>
      <div class="nav-container">
        <!-- Burger menu déplacé en premier -->
        <div class="burger-menu" id="burger-menu">
          <span></span>
          <span></span>
          <span></span>
        </div>
        <!-- Logo déplacé après -->
        <object
          id="winback-logo"
          data="img/logoWB.svg"
          type="image/svg+xml"
        ></object>
      </div>
      <div class="nav-controls">
        <!-- Suppression du bloc search-container -->
        <div class="theme-toggle">
          <label for="toggle" class="switch">
            <span class="switch-label"></span>
            <input type="checkbox" id="toggle" aria-label="Toggle dark mode" />
            <span class="slider"></span>
          </label>
        </div>
      </div>
    </nav>
    <div class="disclaimer-top">
      <div class="disclaimer" id="disclaimer">
        <div class="disclaimer-content">
          <div class="language-selector">
            <div class="selected-flag"></div>
            <div class="flag-dropdown" id="flag-dropdown">
              <div class="flag-option" data-value="en" data-flag="gb"></div>
              <div class="flag-option" data-value="fr" data-flag="fr"></div>
              <div class="flag-option" data-value="de" data-flag="de"></div>
              <div class="flag-option" data-value="nl" data-flag="nl"></div>
              <div class="flag-option" data-value="el" data-flag="gr"></div>
              <div class="flag-option" data-value="hu" data-flag="hu"></div>
              <div class="flag-option" data-value="it" data-flag="it"></div>
              <div class="flag-option" data-value="pl" data-flag="pl"></div>
              <div class="flag-option" data-value="pt" data-flag="pt"></div>
              <div class="flag-option" data-value="es" data-flag="es"></div>
              <div class="flag-option" data-value="sv" data-flag="se"></div>
              <div class="flag-option" data-value="tr" data-flag="tr"></div>
            </div>
            <img src="img/Arrow.png" alt="arrow" class="lang-arrow" />
          </div>
          <span>
            <span data-translate="disclaimer_text_start"></span>
            <a
              href="tel:+33483661666"
              class="contact-link"
              data-translate="phone"
            ></a>
            <span data-translate="disclaimer_text_middle"></span>
            <a
              href="mailto:hello@winback.com"
              class="contact-link"
              data-translate="email"
            ></a>
          </span>
        </div>
      </div>
    </div>
    <header>
      <h2 data-translate="main-title">Release Notes</h2>
      <!-- Suppression de la div slideshow-container et slideshow-image -->
    </header>

    <main>
      <div class="sidebar hidden" id="sidebar">
        <ul>
          <li>
            <a href="#version46">
              Version 4.6
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version43">
              Version 4.3
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version42">
              Version 4.2
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version339">
              Version 3.39
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version334">
              Version 3.34
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version333">
              Version 3.33
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version327">
              Version 3.27
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version320">
              Version 3.20
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version317">
              Version 3.17
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version314">
              Version 3.14
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
        </ul>
      </div>

      <div class="content">
        <div class="version-container" id="version-container">
          <!-- Les versions seront générées ici dynamiquement -->
        </div>
      </div>
    </main>

    <script type="module">
      import { updateVersionDisplay } from "./js/versionDisplay.js";
      import translations from "./js/translations.js";

      const toggle = document.getElementById("toggle");
      const body = document.body;
      const winbackLogo = document.getElementById("winback-logo");
      const burgerMenu = document.getElementById("burger-menu");
      const sidebar = document.getElementById("sidebar");

      // Fonction pour fermer la sidebar
      function closeSidebar() {
        burgerMenu.classList.remove("active");
        sidebar.classList.add("hidden");
        sidebar.classList.remove("visible");
        body.classList.remove("sidebar-open");
      }

      // Mode sombre
      const darkMode = localStorage.getItem("darkMode");
      if (darkMode === "enabled") {
        body.classList.add("dark-mode");
        toggle.checked = true;
        updateLogoColor(true);
      }

      function updateLogoColor(isDark) {
        if (winbackLogo && winbackLogo.contentDocument) {
          const paths = winbackLogo.contentDocument.querySelectorAll("path");
          paths.forEach((path) => {
            if (path.getAttribute("fill") !== "#F18841") {
              path.style.fill = isDark ? "#FFFFFF" : "#000000";
            }
          });
        }
      }

      // Gestionnaire d'événement pour le switch
      toggle.addEventListener("change", () => {
        if (toggle.checked) {
          body.classList.add("dark-mode");
          localStorage.setItem("darkMode", "enabled");
          updateLogoColor(true);
        } else {
          body.classList.remove("dark-mode");
          localStorage.setItem("darkMode", "disabled");
          updateLogoColor(false);
        }
      });

      // Mettre à jour la couleur du logo quand il est chargé
      winbackLogo.addEventListener("load", function () {
        updateLogoColor(body.classList.contains("dark-mode"));
      });

      // Menu burger
      burgerMenu.addEventListener("click", () => {
        burgerMenu.classList.toggle("active");
        sidebar.classList.toggle("hidden");
        sidebar.classList.toggle("visible");
        body.classList.toggle("sidebar-open");
      });

      // Initialiser la sidebar
      function initializeSidebar() {
        if (window.innerWidth <= 768) {
          sidebar.classList.add("hidden");
          sidebar.classList.remove("visible");
          body.classList.remove("sidebar-open");
        } else {
          sidebar.classList.remove("hidden");
          sidebar.classList.add("visible");
          body.classList.add("sidebar-open");
        }
      }

      window.addEventListener("load", initializeSidebar);
      window.addEventListener("resize", initializeSidebar);

      // Détails des versions
      document.querySelectorAll(".version h2").forEach((header) => {
        header.addEventListener("click", function () {
          const details = this.nextElementSibling.nextElementSibling;
          const arrow = this.querySelector(".arrow-icon");
          details.classList.toggle("show");
          arrow.style.transform = details.classList.contains("show");
          // ? "rotate(90deg)"
          // : "rotate(0deg)";
        });
      });

      // Supprimer les event listeners pour la recherche

      // Gestion de la langue
      function updateLanguage(lang) {
        // Vérifier si la langue existe dans les traductions
        if (!translations[lang]) {
          console.warn(`Language ${lang} not found in translations`);
          lang = "en"; // Fallback to English
        }

        // Mettre à jour tous les éléments avec data-translate dans tout le document
        const elementsToTranslate =
          document.querySelectorAll("[data-translate]");

        elementsToTranslate.forEach((element) => {
          const key = element.getAttribute("data-translate");

          // Vérifier si la clé existe dans les traductions
          if (translations[lang][key]) {
            if (element.tagName === "INPUT" || element.tagName === "TEXTAREA") {
              element.placeholder = translations[lang][key];
            } else if (element.tagName === "META") {
              element.content = translations[lang][key];
            } else if (
              element.tagName === "A" &&
              element.classList.contains("contact-link")
            ) {
              // Traitement spécial pour les liens de contact
              element.textContent = translations[lang][key];
            } else {
              element.textContent = translations[lang][key];
            }
          } else {
            console.warn(
              `Translation key "${key}" not found for language ${lang}`
            );
          }
        });

        // Mettre à jour la langue du document
        document.documentElement.lang = lang;

        // Sauvegarder la préférence de langue
        localStorage.setItem("selectedLanguage", lang);
      }

      document.addEventListener("DOMContentLoaded", function () {
        const languageSelector = document.querySelector(".language-selector");
        const selectedFlag = document.querySelector(".selected-flag");
        const flagOptions = document.querySelectorAll(".flag-option");

        // Fonction pour mettre à jour le drapeau sélectionné
        function updateSelectedFlag(flagCode) {
          selectedFlag.style.backgroundImage = `url(https://flagicons.lipis.dev/flags/4x3/${flagCode}.svg)`;
        }

        // Initialiser avec le drapeau anglais et la langue anglaise
        updateSelectedFlag("gb");
        updateLanguage("en");

        // Toggle du dropdown
        languageSelector.addEventListener("click", function (e) {
          languageSelector.classList.toggle("active");
        });

        // Gestion des clics sur les drapeaux
        flagOptions.forEach((option) => {
          const flagCode = option.dataset.flag;
          option.style.backgroundImage = `url(https://flagicons.lipis.dev/flags/4x3/${flagCode}.svg)`;

          option.addEventListener("click", function (e) {
            e.stopPropagation();
            const value = this.dataset.value;
            const flagCode = this.dataset.flag;

            updateSelectedFlag(flagCode);
            updateLanguage(value);
            languageSelector.classList.remove("active");
          });
        });

        // Fermer le dropdown quand on clique ailleurs
        document.addEventListener("click", function (e) {
          if (!languageSelector.contains(e.target)) {
            languageSelector.classList.remove("active");
          }
        });
      });
    </script>
    <!-- Suppression du script de slideshow en bas du fichier -->
    <!--
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const images = document.querySelectorAll(".slideshow-image");
        let currentImageIndex = 0;

        function nextImage() {
          images[currentImageIndex].classList.remove("active");
          currentImageIndex = (currentImageIndex + 1) % images.length;
          images[currentImageIndex].classList.add("active");
        }

        setInterval(nextImage, 5000);
      });
    </script>
    -->
  </body>
</html>
